[{"id":"3cf5f2e0-d70e-4932-a463-5a69f779b9ea","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=influxdb,image=coreos-alpha,size=512mb,id=3cf5f2e0-d70e-4932-a463-5a69f779b9ea\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit influxdb.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start influxdb; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/influxdb.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=influxdb.service\n      \n      After=bootstrap.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      EnvironmentFile=/etc/environment\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull tutum/influxdb:latest\n      ExecStart=/usr/bin/bash -c \"/usr/bin/etcdctl set /services/influxdb/influxdb.service ${COREOS_PUBLIC_IPV4}:8086 && /usr/bin/docker run --rm --name %p -p 8083:8083 -p 8086:8086 --expose 8090 --expose 8099 -e PRE_CREATE_DB=cadvisor tutum/influxdb:latest\"\n      ExecStop=/usr/bin/docker stop %p\n      ExecStopPost=/usr/bin/etcdctl rm /services/influxdb/influxdb.service\n      \n      [X-Fleet]\n      MachineMetadata=role=influxdb\n","response":{"droplet":{"id":2736112,"name":"3cf5f2e0-d70e-4932-a463-5a69f779b9ea","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:48Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431381,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431381"}]}}},{"id":"53917538-7376-4bcd-bfff-f176a9b8d5e9","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=grafana,image=coreos-alpha,size=512mb,id=53917538-7376-4bcd-bfff-f176a9b8d5e9\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit grafana.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start grafana; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/grafana.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=grafana\n      \n      After=bootstrap.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull tutum/grafana:latest\n      ExecStart=/usr/bin/bash -c \"INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service) INFLUXDB_HOST=$(echo $INFLUXDB | /usr/bin/awk -F':' '{print $1}') INFLUXDB_PORT=$(echo $INFLUXDB | /usr/bin/awk -F':' '{print $2}') && /usr/bin/docker run --rm --name=%p -p 80:80 -e HTTP_USER=root -e HTTP_PASS=root -e INFLUXDB_HOST=$INFLUXDB_HOST -e INFLUXDB_PORT=$INFLUXDB_PORT -e INFLUXDB_NAME=cadvisor tutum/grafana:latest\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      MachineMetadata=role=grafana\n","response":{"droplet":{"id":2736113,"name":"53917538-7376-4bcd-bfff-f176a9b8d5e9","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:48Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431382,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431382"}]}}},{"id":"c39cf3b9-cbf1-4d17-822b-361f9b3af4ac","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=c39cf3b9-cbf1-4d17-822b-361f9b3af4ac\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@c39cf3b9-cbf1-4d17-822b-361f9b3af4ac; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736114,"name":"c39cf3b9-cbf1-4d17-822b-361f9b3af4ac","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:49Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431383,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431383"}]}}},{"id":"f2eb01b1-08e6-4d28-9dde-8af8a10dd310","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=f2eb01b1-08e6-4d28-9dde-8af8a10dd310\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@f2eb01b1-08e6-4d28-9dde-8af8a10dd310; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736115,"name":"f2eb01b1-08e6-4d28-9dde-8af8a10dd310","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:49Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431384,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431384"}]}}},{"id":"6ff26967-c6db-4060-9bd8-6eefa3da145b","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=6ff26967-c6db-4060-9bd8-6eefa3da145b\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@6ff26967-c6db-4060-9bd8-6eefa3da145b; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736116,"name":"6ff26967-c6db-4060-9bd8-6eefa3da145b","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:50Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431385,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431385"}]}}},{"id":"86908fb2-9f90-48c6-abdc-b2364bcbd670","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=86908fb2-9f90-48c6-abdc-b2364bcbd670\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@86908fb2-9f90-48c6-abdc-b2364bcbd670; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736117,"name":"86908fb2-9f90-48c6-abdc-b2364bcbd670","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:52Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431387,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431387"}]}}},{"id":"97fbcb05-fcce-4f63-b0c2-0c3472fe9acf","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=97fbcb05-fcce-4f63-b0c2-0c3472fe9acf\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@97fbcb05-fcce-4f63-b0c2-0c3472fe9acf; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736118,"name":"97fbcb05-fcce-4f63-b0c2-0c3472fe9acf","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:52Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431390,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431390"}]}}},{"id":"94aaa244-c096-4729-b73c-c50f4fa4f7c1","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=94aaa244-c096-4729-b73c-c50f4fa4f7c1\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@94aaa244-c096-4729-b73c-c50f4fa4f7c1; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736119,"name":"94aaa244-c096-4729-b73c-c50f4fa4f7c1","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:54Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431391,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431391"}]}}},{"id":"6ee0236a-7d73-45ff-b3a8-deef517e7844","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=6ee0236a-7d73-45ff-b3a8-deef517e7844\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@6ee0236a-7d73-45ff-b3a8-deef517e7844; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736120,"name":"6ee0236a-7d73-45ff-b3a8-deef517e7844","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:54Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431392,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431392"}]}}},{"id":"0b7e82ce-1cd4-46c3-b0c4-c4731a26e6f7","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=0b7e82ce-1cd4-46c3-b0c4-c4731a26e6f7\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@0b7e82ce-1cd4-46c3-b0c4-c4731a26e6f7; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736121,"name":"0b7e82ce-1cd4-46c3-b0c4-c4731a26e6f7","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:55Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431393,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431393"}]}}},{"id":"44e017c4-5342-4065-9ed4-797f34f219db","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=44e017c4-5342-4065-9ed4-797f34f219db\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@44e017c4-5342-4065-9ed4-797f34f219db; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736122,"name":"44e017c4-5342-4065-9ed4-797f34f219db","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:56Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431394,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431394"}]}}},{"id":"f39d79d7-be11-4f73-9f98-e266520847c5","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=f39d79d7-be11-4f73-9f98-e266520847c5\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@f39d79d7-be11-4f73-9f98-e266520847c5; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736123,"name":"f39d79d7-be11-4f73-9f98-e266520847c5","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:57Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431395,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431395"}]}}},{"id":"38616940-209a-4b33-b7b0-10a90f1cfa19","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=38616940-209a-4b33-b7b0-10a90f1cfa19\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@38616940-209a-4b33-b7b0-10a90f1cfa19; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736124,"name":"38616940-209a-4b33-b7b0-10a90f1cfa19","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:59Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431397,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431397"}]}}},{"id":"475d9d33-a1df-4a6b-a705-eb6c88ded485","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=475d9d33-a1df-4a6b-a705-eb6c88ded485\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@475d9d33-a1df-4a6b-a705-eb6c88ded485; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736125,"name":"475d9d33-a1df-4a6b-a705-eb6c88ded485","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:19:59Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431399,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431399"}]}}},{"id":"c4d56c88-8a6e-4474-97fc-229cf435ebb6","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=c4d56c88-8a6e-4474-97fc-229cf435ebb6\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@c4d56c88-8a6e-4474-97fc-229cf435ebb6; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736128,"name":"c4d56c88-8a6e-4474-97fc-229cf435ebb6","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:01Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431402,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431402"}]}}},{"id":"e7344b57-e49c-487f-982f-cbb6cb419650","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=e7344b57-e49c-487f-982f-cbb6cb419650\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@e7344b57-e49c-487f-982f-cbb6cb419650; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736129,"name":"e7344b57-e49c-487f-982f-cbb6cb419650","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:01Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431403,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431403"}]}}},{"id":"0091c446-090d-4c2b-be71-0d882c268910","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=0091c446-090d-4c2b-be71-0d882c268910\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@0091c446-090d-4c2b-be71-0d882c268910; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736130,"name":"0091c446-090d-4c2b-be71-0d882c268910","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:04Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431404,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431404"}]}}},{"id":"fc5e766b-08f6-4eac-b6b7-16915720d4e3","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=fc5e766b-08f6-4eac-b6b7-16915720d4e3\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@fc5e766b-08f6-4eac-b6b7-16915720d4e3; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736132,"name":"fc5e766b-08f6-4eac-b6b7-16915720d4e3","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:02Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431406,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431406"}]}}},{"id":"81f51c8d-06ca-4d6d-adcc-5fd8c425239e","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=81f51c8d-06ca-4d6d-adcc-5fd8c425239e\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@81f51c8d-06ca-4d6d-adcc-5fd8c425239e; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736133,"name":"81f51c8d-06ca-4d6d-adcc-5fd8c425239e","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:04Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431409,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431409"}]}}},{"id":"653e96fd-87c8-4fd3-a1d3-1889c53f9a2d","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=653e96fd-87c8-4fd3-a1d3-1889c53f9a2d\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@653e96fd-87c8-4fd3-a1d3-1889c53f9a2d; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736134,"name":"653e96fd-87c8-4fd3-a1d3-1889c53f9a2d","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:04Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431410,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431410"}]}}},{"id":"d59223e7-0167-4c3b-9ed3-90d7649be797","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=d59223e7-0167-4c3b-9ed3-90d7649be797\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@d59223e7-0167-4c3b-9ed3-90d7649be797; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736135,"name":"d59223e7-0167-4c3b-9ed3-90d7649be797","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:06Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431411,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431411"}]}}},{"id":"96fbdf37-11e0-44a3-abc9-1a873d59ce12","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=96fbdf37-11e0-44a3-abc9-1a873d59ce12\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@96fbdf37-11e0-44a3-abc9-1a873d59ce12; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736136,"name":"96fbdf37-11e0-44a3-abc9-1a873d59ce12","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:06Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431413,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431413"}]}}},{"id":"b7b5e789-9fca-4e94-9a6d-494287ced5ca","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=b7b5e789-9fca-4e94-9a6d-494287ced5ca\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@b7b5e789-9fca-4e94-9a6d-494287ced5ca; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736137,"name":"b7b5e789-9fca-4e94-9a6d-494287ced5ca","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:06Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431414,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431414"}]}}},{"id":"0c4920a6-845d-4722-b583-08e7931db4d6","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=0c4920a6-845d-4722-b583-08e7931db4d6\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@0c4920a6-845d-4722-b583-08e7931db4d6; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736138,"name":"0c4920a6-845d-4722-b583-08e7931db4d6","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:07Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431417,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431417"}]}}},{"id":"9ee1a164-503b-4533-9a3b-60ec42f7eac5","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=9ee1a164-503b-4533-9a3b-60ec42f7eac5\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@9ee1a164-503b-4533-9a3b-60ec42f7eac5; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736139,"name":"9ee1a164-503b-4533-9a3b-60ec42f7eac5","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:08Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431419,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431419"}]}}},{"id":"b9d02ff9-ad29-4c0f-bb4c-aa54209df119","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=b9d02ff9-ad29-4c0f-bb4c-aa54209df119\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@b9d02ff9-ad29-4c0f-bb4c-aa54209df119; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736140,"name":"b9d02ff9-ad29-4c0f-bb4c-aa54209df119","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:09Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431420,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431420"}]}}},{"id":"8a35fdfb-b740-491d-be84-c4bacf39c0b7","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=8a35fdfb-b740-491d-be84-c4bacf39c0b7\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@8a35fdfb-b740-491d-be84-c4bacf39c0b7; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736141,"name":"8a35fdfb-b740-491d-be84-c4bacf39c0b7","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:09Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431421,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431421"}]}}},{"id":"53acbad5-d6a3-4758-bcd4-bc0993a412e3","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=53acbad5-d6a3-4758-bcd4-bc0993a412e3\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@53acbad5-d6a3-4758-bcd4-bc0993a412e3; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736142,"name":"53acbad5-d6a3-4758-bcd4-bc0993a412e3","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:10Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431423,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431423"}]}}},{"id":"cf1a998a-bcb2-4aee-be50-1ad894462c74","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=cf1a998a-bcb2-4aee-be50-1ad894462c74\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@cf1a998a-bcb2-4aee-be50-1ad894462c74; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736143,"name":"cf1a998a-bcb2-4aee-be50-1ad894462c74","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:11Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431424,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431424"}]}}},{"id":"60aefcfb-94a6-440d-8d03-8baac64a5d55","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=60aefcfb-94a6-440d-8d03-8baac64a5d55\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@60aefcfb-94a6-440d-8d03-8baac64a5d55; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736144,"name":"60aefcfb-94a6-440d-8d03-8baac64a5d55","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:12Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431425,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431425"}]}}},{"id":"e74c0141-1f89-4530-be80-dcb9576062d5","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=e74c0141-1f89-4530-be80-dcb9576062d5\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@e74c0141-1f89-4530-be80-dcb9576062d5; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736145,"name":"e74c0141-1f89-4530-be80-dcb9576062d5","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:13Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431426,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431426"}]}}},{"id":"1f6a20d8-9903-48f6-8af0-9e64cb571f69","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=1f6a20d8-9903-48f6-8af0-9e64cb571f69\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@1f6a20d8-9903-48f6-8af0-9e64cb571f69; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736146,"name":"1f6a20d8-9903-48f6-8af0-9e64cb571f69","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:14Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431427,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431427"}]}}},{"id":"003c2dd6-0c81-4045-a0ee-0108c61b9da1","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=003c2dd6-0c81-4045-a0ee-0108c61b9da1\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@003c2dd6-0c81-4045-a0ee-0108c61b9da1; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736148,"name":"003c2dd6-0c81-4045-a0ee-0108c61b9da1","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:15Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431429,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431429"}]}}},{"id":"f1b2dc0c-40ed-449c-a492-c69f1b3f16b1","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=f1b2dc0c-40ed-449c-a492-c69f1b3f16b1\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@f1b2dc0c-40ed-449c-a492-c69f1b3f16b1; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736149,"name":"f1b2dc0c-40ed-449c-a492-c69f1b3f16b1","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:16Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431430,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431430"}]}}},{"id":"e6a93566-e1cc-4a9e-a36c-9908485f197b","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=e6a93566-e1cc-4a9e-a36c-9908485f197b\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@e6a93566-e1cc-4a9e-a36c-9908485f197b; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736150,"name":"e6a93566-e1cc-4a9e-a36c-9908485f197b","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:16Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431431,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431431"}]}}},{"id":"c5a84f8c-9fdc-437d-ba04-eee936b3049b","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=c5a84f8c-9fdc-437d-ba04-eee936b3049b\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@c5a84f8c-9fdc-437d-ba04-eee936b3049b; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736151,"name":"c5a84f8c-9fdc-437d-ba04-eee936b3049b","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:18Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431432,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431432"}]}}},{"id":"1b88e7ad-7c5d-4b77-9461-337ce1258ce7","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=1b88e7ad-7c5d-4b77-9461-337ce1258ce7\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@1b88e7ad-7c5d-4b77-9461-337ce1258ce7; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736152,"name":"1b88e7ad-7c5d-4b77-9461-337ce1258ce7","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:18Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431434,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431434"}]}}},{"id":"f1d2747b-f3f9-44d0-af48-c97989b6c73c","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=f1d2747b-f3f9-44d0-af48-c97989b6c73c\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@f1d2747b-f3f9-44d0-af48-c97989b6c73c; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736153,"name":"f1d2747b-f3f9-44d0-af48-c97989b6c73c","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:19Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431435,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431435"}]}}},{"id":"059b2df5-f4c0-43a2-beb4-d2c797a0f2b9","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=059b2df5-f4c0-43a2-beb4-d2c797a0f2b9\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@059b2df5-f4c0-43a2-beb4-d2c797a0f2b9; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736154,"name":"059b2df5-f4c0-43a2-beb4-d2c797a0f2b9","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:21Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431436,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431436"}]}}},{"id":"ad96dff3-100e-4af4-99ac-b84e935044a2","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=ad96dff3-100e-4af4-99ac-b84e935044a2\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@ad96dff3-100e-4af4-99ac-b84e935044a2; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736155,"name":"ad96dff3-100e-4af4-99ac-b84e935044a2","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:21Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431437,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431437"}]}}},{"id":"7f5a85bf-98bc-4905-8f00-f357f6a6778c","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=7f5a85bf-98bc-4905-8f00-f357f6a6778c\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@7f5a85bf-98bc-4905-8f00-f357f6a6778c; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736156,"name":"7f5a85bf-98bc-4905-8f00-f357f6a6778c","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:21Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431438,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431438"}]}}},{"id":"ac0ca1ec-1802-4950-a035-883536134681","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=ac0ca1ec-1802-4950-a035-883536134681\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@ac0ca1ec-1802-4950-a035-883536134681; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736157,"name":"ac0ca1ec-1802-4950-a035-883536134681","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:23Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431439,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431439"}]}}},{"id":"4e8be02b-120d-4793-aa36-fa1c8a5c4fc8","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=4e8be02b-120d-4793-aa36-fa1c8a5c4fc8\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@4e8be02b-120d-4793-aa36-fa1c8a5c4fc8; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736158,"name":"4e8be02b-120d-4793-aa36-fa1c8a5c4fc8","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:23Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431442,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431442"}]}}},{"id":"94d8ee04-16cb-4290-86a7-762ac0505713","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=94d8ee04-16cb-4290-86a7-762ac0505713\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@94d8ee04-16cb-4290-86a7-762ac0505713; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736159,"name":"94d8ee04-16cb-4290-86a7-762ac0505713","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:26Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431443,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431443"}]}}},{"id":"0e95c274-0c3a-4436-89a3-00756bf0b5bd","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=0e95c274-0c3a-4436-89a3-00756bf0b5bd\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@0e95c274-0c3a-4436-89a3-00756bf0b5bd; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736160,"name":"0e95c274-0c3a-4436-89a3-00756bf0b5bd","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:26Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431444,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431444"}]}}},{"id":"a7d42db0-20b0-4faf-9457-55342f636473","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=a7d42db0-20b0-4faf-9457-55342f636473\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@a7d42db0-20b0-4faf-9457-55342f636473; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736161,"name":"a7d42db0-20b0-4faf-9457-55342f636473","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:26Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431445,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431445"}]}}},{"id":"9fb96802-eef5-426a-ab3d-e1541b42ae54","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=9fb96802-eef5-426a-ab3d-e1541b42ae54\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@9fb96802-eef5-426a-ab3d-e1541b42ae54; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736162,"name":"9fb96802-eef5-426a-ab3d-e1541b42ae54","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:26Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431446,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431446"}]}}},{"id":"8384d37f-31d1-4534-b2b8-11dd6e344193","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=8384d37f-31d1-4534-b2b8-11dd6e344193\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@8384d37f-31d1-4534-b2b8-11dd6e344193; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736163,"name":"8384d37f-31d1-4534-b2b8-11dd6e344193","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:27Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431448,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431448"}]}}},{"id":"e94845f9-9772-4a57-be33-c084f9140180","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=e94845f9-9772-4a57-be33-c084f9140180\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@e94845f9-9772-4a57-be33-c084f9140180; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736164,"name":"e94845f9-9772-4a57-be33-c084f9140180","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:27Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431449,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431449"}]}}},{"id":"d0453080-0691-4e39-b7c3-3404277b28a0","provider":"digitalocean","location":"sfo1","size":"512mb","image":"coreos-alpha","keys":["40:85:f0:9b:28:ad:5d:25:b5:51:2e:ad:f3:b3:31:98"],"userData":"#cloud-config\n\ncoreos:\n  etcd:\n    discovery: https://discovery.etcd.io/16dcfe6b60b468ea5f4a3646479f7075\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n    metadata: provider=digitalocean,location=sfo1,role=broadcaster,image=coreos-alpha,size=512mb,id=d0453080-0691-4e39-b7c3-3404277b28a0\n\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDQIwGRmmZKxKiZyWRkGk95wBUuhmyitOfJQBlhLeL7n0qDxueU+oxRH3swrWYbHY8daOAKhlzQmpqAQSoFiLzdK0N5aDRyv5U01wvzRuWbQ3Fk/2iwOUzJx2y/rDVd3NbF26EBTS+7mS2n319r1TNYsuekzMD+VpZBFymcqttoOlgNnuecytpMFj18YuB3muGRgiAWZHx0md1e3/bVuVK16VEJ8MKFPWBsRiZ667gzW5b88XZO4Zvo/wAQgp6vakMaLOinxOt0IhfsVNU/miFd0AMBPq04s+iSApxBvQ/+DbBphQT4bRfgI8w8QgfwO8Hwz4MpojeAk2Dhsvmupyp blakelapierre@gmail.com\n\n  units:\n    - name: etcd.service\n      command: start\n\n    - name: fleet.socket\n      command: start\n      content: |\n        [Socket]\n        ListenStream=/var/run/fleet.socket\n        Service=fleet.service\n\n        [Install]\n        WantedBy=sockets.target\n\n    - name: fleet.service\n      command: start\n\n    - name: bootstrap.service\n      command: start\n      content: |\n        [Unit]\n        Description=boostraps us\n\n        Requires=etcd.service\n        Requires=fleet.socket\n        Requires=fleet.service\n        Requires=docker.service\n\n        After=etcd.service\n        After=fleet.socket\n        After=fleet.service\n        After=docker.service\n\n        [Service]\n        ExecStart=/home/core/bootstrap.sh\n\nwrite_files:\n  - path: /home/core/bootstrap.sh\n    owner: core\n    permissions: 0700\n    content: |\n      #!/bin/bash\n      \n      #DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n      \n      cd /home/core\n      \n      \n      (\n        SWAPSIZE=4G\n        SWAPFILE=/${SWAPSIZE}iB.swap\n        sudo /usr/bin/fallocate -l ${SWAPSIZE} ${SWAPFILE};\n        sudo /usr/bin/chmod 600 ${SWAPFILE};\n        sudo /usr/bin/chattr +C ${SWAPFILE};\n        sudo /usr/sbin/mkswap ${SWAPFILE};\n        sudo /usr/sbin/losetup -f ${SWAPFILE};\n        sudo /usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1);\n      ) &\n      \n      until etcdctl set /machines/$(hostname)/\"$(date)\" 1; do echo 'etcd not ready...sleeping' && sleep 1; done\n      \n      until fleetctl list-units; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl submit cadvisor.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      until fleetctl submit broadcaster@.service; do echo 'fleet not ready...sleeping' && sleep 1; done\n      \n      until fleetctl start cadvisor; do echo 'fleect not ready...sleeping' && sleep 1; done\n      until fleetctl start broadcaster@d0453080-0691-4e39-b7c3-3404277b28a0; do echo 'fleect not ready...sleeping' && sleep 1; done\n      \n  - path: /home/core/cadvisor.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=cadvisor\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      \n      [Service]\n      TimeoutStartSec=0\n      Restart=always\n      ExecStartPre=-/usr/bin/docker kill %p\n      ExecStartPre=-/usr/bin/docker rm %p\n      ExecStartPre=/usr/bin/docker pull google/cadvisor:latest\n      ExecStart=/usr/bin/bash -c \"until INFLUXDB=$(/usr/bin/etcdctl get /services/influxdb/influxdb.service); do echo 'influxdb not found...retrying' && sleep 1; done && /usr/bin/docker run --rm --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --name=%p google/cadvisor:latest -storage_driver=influxdb -log_dir=/ -storage_driver_host=$INFLUXDB\"\n      ExecStop=/usr/bin/docker stop %p\n      \n      [X-Fleet]\n      Global=true\n      \n  - path: /home/core/broadcaster@.service\n    owner: core\n    permissions: 0600\n    content: |\n      [Unit]\n      Description=broadcaster@%i\n      \n      After=etcd.service\n      After=fleet.service\n      After=docker.service\n      After=collectd.service\n      \n      [Service]\n      TimeoutStartSec=0\n      ExecStartPre=-/usr/bin/docker kill %p.%i\n      ExecStartPre=-/usr/bin/docker rm %p.%i\n      ExecStartPre=-/usr/bin/docker pull instantchat/broadcaster\n      ExecStart=/usr/bin/docker run --name=%p.%i --rm --privileged instantchat/broadcaster\n      ExecStop=/usr/bin/docker stop %p.%i\n      \n      [X-Fleet]\n      MachineMetadata=role=broadcaster\n","response":{"droplet":{"id":2736165,"name":"d0453080-0691-4e39-b7c3-3404277b28a0","memory":512,"vcpus":1,"disk":20,"region":{"slug":"sfo1","name":"San Francisco 1","sizes":["2gb","4gb","8gb","1gb","16gb","32gb","48gb","512mb","64gb"],"available":true,"features":["virtio","backups","metadata"]},"image":{"id":6198091,"name":"CoreOS 444.0.0 (alpha)","distribution":"CoreOS","slug":"coreos-alpha","public":true,"regions":["sfo1","sgp1","lon1","nyc3","ams3"],"created_at":"2014-09-20T02:07:59Z"},"size":{"slug":"512mb","transfer":1,"price_monthly":5,"price_hourly":0.00744},"locked":true,"status":"new","networks":{},"kernel":null,"created_at":"2014-09-29T15:20:28Z","features":["virtio"],"backup_ids":[],"snapshot_ids":[]},"links":{"actions":[{"id":33431450,"rel":"create","href":"http://api.digitalocean.com/v2/actions/33431450"}]}}}]