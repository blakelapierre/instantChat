{"version":3,"sources":["/home/blake/development/instantChat/admin/gen.js"],"names":[],"mappings":"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","sourceRoot":"/home/blake/development/instantChat/admin/","sourcesContent":["function* loopUntilEmpty(q) {\n  console.log(q);\n  var queue = {q},\n      next = 0;\n\n  queue.remove = obj => {\n    var index = q.indexOf(obj);\n    if (index != -1) {\n      q.splice(index, 1);\n      if (next >= index) {\n        next = next == 0 ? q.length - 1 : next - 1;\n      }\n    }\n    else throw Error('Tried to remove object that is not in q', obj, q);\n  };\n\n  queue.add = (index, obj) => {\n    q.splice(index, 0, obj);\n    if (index < next) {\n      next = next + 1;\n    }\n  };\n\n  yield queue; //yeah, we want to get rid of this\n\n  while (q.length > 0) {\n    next = next % q.length;\n    yield q[next];\n    next = next + 1;\n  }\n}\n\n\nvar q = [\n  clusterMachineGenerator(10, 'sfo1-'),\n  clusterMachineGenerator(5, 'nyc3-'),\n  clusterMachineGenerator(7, 'lon1-')\n];\n\nfunction* clusterMachineGenerator(machineCount, prefix) {\n  prefix = prefix || '';\n  for (var i = 0; i < machineCount; i++) yield generateMachine(i);\n\n  function generateMachine(number) {\n    return { id: prefix + i.toString() };\n  }\n}\n\nfunction* generator2() {\n  var loop = loopUntilEmpty(q),\n      queue = loop.next().value;\n  var generatorResult;\n  do {\n    generatorResult = loop.next();\n\n    if (generatorResult.done) return;\n    else {\n      var machineGenerator = generatorResult.value,\n          machineResult = machineGenerator.next();\n\n      if (machineResult.done) queue.remove(machineGenerator);\n      else yield machineResult.value;\n    }\n  } while (!generatorResult.done);\n}\n\nvar gen = generator2();\n\nvar i = 0,\n    result;\ndo {\n  // if (i == 21) q.remove(0);\n  // if (i == 30) q.add(1, clusterMachineGenerator(4));\n  result = gen.next();\n  if (!result.done) console.log(i++, result.value);\n} while (!result.done);"]}